/*global require, beforeEach, describe, it */
/*jshint -W030, -W097 */
var _require = require('root-require');
var expect = require('chai').expect;
// var fumble = require('fumble');
var Immutable = require('immutable');

var HeaderStore = _require('stores/HeaderStore');

describe('stores/HeaderStore.js', function () {
    describe('#store', function () {
        var store;

        beforeEach(function () {
            store = new HeaderStore();
        });

        describe('#initialize', function () {
            it('should return true', function () {
                expect(true).to.be.true;
                expect(store.getState()).to.be.deep.equal(Immutable.fromJS({}));
                expect(store.getSite()).to.be.false;
            });
        });

        describe('#handlers', function () {
            describe('{ }', function () {
                it('NAV_SUCCESS', function (done) {
                    var payload = Immutable.fromJS({});
                    store.on('change', function () {
                        expect(store.getSite()).to.be.false;
                        done();
                    });
                    store._handleNavSuccess(payload);
                });
            });

            describe('{ params.contentSite=\'news\' }', function () {
                it('NAV_SUCCESS', function (done) {
                    var payload = Immutable.fromJS({
                        contentSite: 'finance',
                        params: {
                            contentSite: 'news'
                        },
                        query: {
                            site: 'sports'
                        }
                    });
                    store.on('change', function () {
                        expect(store.getSite()).to.be.deep.equal('news');
                        done();
                    });
                    store._handleNavSuccess(payload);
                });
            });

            describe('{ contentSite=\'finance\' }', function () {
                it('NAV_SUCCESS', function (done) {
                    var payload = Immutable.fromJS({
                        contentSite: 'finance',
                        query: {
                            site: 'sports'
                        }
                    });
                    store.on('change', function () {
                        expect(store.getSite()).to.be.deep.equal('finance');
                        done();
                    });
                    store._handleNavSuccess(payload);
                });
            });

            describe('{ query.site=\'sports\' }', function () {
                it('NAV_SUCCESS', function (done) {
                    var payload = Immutable.fromJS({
                        query: {
                            site: 'sports'
                        }
                    });
                    store.on('change', function () {
                        expect(store.getSite()).to.be.deep.equal('sports');
                        done();
                    });
                    store._handleNavSuccess(payload);
                });
            });
        });
    });
});
