'use strict';

var parent = module.parent;

/**
* ###### HACK! ######
* This is needed so that ynodejs can require the file
* to start the server (for functional testing), but also
* allow the package to be required by other libraries.
*
* An enhancement has been requested to make this less hacky:
* https://jira.corp.yahoo.com/browse/NODEJS-110
*/
if (parent && parent.filename.indexOf('ynodejs') !== -1 || process.argv.indexOf('--start') !== -1) {
    // if the file was required by cosmos (ynodejs) then export the server
    process.chdir(__dirname);
    module.exports = require('tdv2-dev-server')(
        {
            lightWeightBrowsers: {
                ie: '8'
            },
            pageOptions: {
                htmlAttrs: {
                    id: 'atomic'
                }
            },
            useReactServer: true
        }
    );
} else {
    // otherwise export as usual
    module.exports = require('./index');
}
